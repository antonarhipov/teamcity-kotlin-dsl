+++
title = "Getting Started"
description = ""
weight = 10
+++

The Kotlin tutorial helps you learn most Kotlin features in a few hours.

You can start working with Kotlin DSL by creating an empty sandbox project on your server and follow the steps below:

1. [Enable versioned settings](http://) for your project.
2. Select Kotlin as the format. Make sure the **Generate portable DSL scripts** option is enabled.
3. Click **Apply** and TeamCity will commit the settings to your repository.

**Note:** After enabling Kotlin for project settings, editing of the project in the web UI may not be available right after the switch. TeamCity needs to detect its own commit in the repository, and only after that editing will be enabled. Usually it takes a minute or two.

## Project Settings Structure

After the commit to the repository, you will get the the .teamcity settings directory with the following files:

* pom.xml
* settings.kts

*settings.kts* is the main file containing all the project configuration, that's the file we will use to change project settings.
*pom.xml* is only required to open the project in an IDE to get the auto-completion feature as well as ability to compile code, write unit tests for it, etc.

## Opening Project in IntelliJ IDEA

To open the Kotlin DSL project in IntelliJ IDEA, open the *.teamcity/pom.xml* file as a project. All necessary dependencies will be resolved automatically right away. If all dependencies have been resolved, no errors in red will be visible in the settings.kts.
If you already have an IntelliJ IDEA project and want to add Kotlin DSL module to it, see this [section](http://).

## Editing Kotlin DSL  

If you created an empty project, that’s what you’ll see in your IDE when you open **settings.kts**:

```kotlin
import jetbrains.buildServer.configs.kotlin.v2018_1.*
/* some comment text  */
version = "2018.1"
 
project {
}
```

`project {}` represents the current project whose settings we'll define in the DSL. This is the same project where we enabled versioned settings on the previous step. This project ID and name can be accessed via a special `DslContext` object but cannot be changed via the DSL. 

You can create different entities in this project by calling `vcsRoot()`, `buildType()`, `template()`, or `subProject()` methods.

For instance, to add a build configuration with a command line script, we can do the following:

```kotlin
import jetbrains.buildServer.configs.kotlin.v2018_1.*
import jetbrains.buildServer.configs.kotlin.v2018_1.buildSteps.script
 
version = "2018.1"
 
project {
  buildType {
    id("HelloWorld")
    name = "Hello world"
    steps {
        script {
            scriptContent = "echo 'Hello world!'"
        }
    }
  }
}
```

After that you can submit this change to the repository, TeamCity will detect it and apply. If there are no errors during the script execution, then we should see a build configuration named "Hello world" in our project.

**Note:** To get familiar with Kotlin API, see the online documentation on your local server, accessible via the link on the **Versioned Settings** project tab in the UI or by running the `mvn -U dependency:sources` command in the IDE. Refer to the documentation on the public TeamCity server as an [example].
You can also use the **Download settings** in Kotlin format option from the project **Actions** menu. For instance, you can find a project that defines some settings that you want to use in your Kotlin DSL project and use this "download" action to see what the DSL generated by TeamCity looks like.

## Patches

TeamCity allows editing of a project via the web interface, even though the project settings are stored in Kotlin DSL. For every change made in the project via the web interface, TeamCity will generate a patch in the Kotlin format, which will be checked in under the project patches directory with subdirectories for different TeamCity entities. For example, if you change a build configuration, TeamCity will submit the *.teamcity/patches/buildTypes/<id>.kt* script to the repository with necessary changes.

For instance, the following patch adds the [Build files cleaner (Swabra)](http://) build feature to the build configuration with the ID SampleProject_Build:

```kotlin
changeBuildType(RelativeId("SampleProject_Build")) { // this part finds the build configuration where the change has to be done 
    features {
        add {
            // this is the part which should be copied to a corresponding place of the settings.kts file
            swabra {
                filesCleanup = Swabra.FilesCleanup.DISABLED
            }
        }
    }
}
```

It is implied that you move the changes from the patch file to you *settings.kts* and delete the patch file.

## Sharing Kotlin DSL Scripts

Besides simplicity, one of the advantages of the portable DSL script is that the script can be used by more than one project or more than one server (hence the name: portable).

If you have a repository with *.teamcity* containing settings in portable format, then you can easily create another project based on these settings. The [Create Project From URL](http://) feature can be used for this.

Simply point TeamCity to your repository and it will detect the *.teamcity* directory and offer to import settings from there:

TODO: image.

**Note:** The *settings.kts* script can always access a `DslContext` object which contains the id and some other settings of the current project.

Based on the context, the DSL script can generate slightly different settings, for instance:

```kotlin
var deployTarget = if (DslContext.projectId == AbsoluteId("Trunk")) {
    "staging"
} else {
    "production"
}
```